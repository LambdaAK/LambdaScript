let rec fold op acc lst <-
  switch lst =>
  | [] -> acc
  | h :: t -> fold op (op acc h) t
  end
in

let rec append a b <-
  switch a =>
  | [] -> b
  | h :: t -> h :: append t b
  end

in

let rec rev lst <-
  switch lst =>
  | [] -> []
  | h :: t -> append (rev t) (h :: [])
  end

in

let rec double lst <-
  switch lst =>
  | [] -> []
  | h :: t -> h :: (append (double t) (double t))
  end

in

fold

filter p lst <- 
  switch lst =>
  | [] -> []
  | h :: t -> if p h then h :: filter p t else filter p t
  end

